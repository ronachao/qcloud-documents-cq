## 接口名称
DescribeCdnProvIspDetailStat

## 功能说明
用于查询指定域名指定日期、指定运营商、指定省份的国内CDN节点消耗明细。由于运营商/省份需要从日志中分析，数据延迟大概为20-30分钟，可以查询最近60天内的数据。

### 详细说明
1. 本接口只查询国内CDN节点的消耗明细
2. 由于省份-运营商组合结果非常多，且本接口返回的为细粒度的数据，数据量较大，暂时不支持太多域名同时查询，一次最多可查询5个域名；
3. 若不填充省份仅指定运营商，则返回的全国每一个省份在该运营商的消耗明细，支持指定多个运营商查询；
4. 若不填充运营商，仅指定省份，则返回该省份每一个运营商的消耗明细，支持指定多个省份查询；
5. 若不填充运营商，也不指定省份，则返回每个省份每一个运营商的消耗明细；
6. 若该省份或运营商无数据，则不会返回；
7. 返回的流量数据的单位是byte(字节），带宽的单位是bps(比特每秒)。

*本接口只支持点播4.0*

## 事件通知
无

## 请求方式

### 请求域名
vod.api.qcloud.com

### 最高调用频率
100次/分钟

### 参数说明
| 参数名称      | 必填 | 类型   | 说明                                                                                                            |
| ------------- | ---- | ------ | --------------------------------------------------------------------------------------------------------------- |
| hosts         | 是   | Array  | 域名列表，一次最多查询5个域名。如果为空，将查询所有域名的统计数据（如果域名超过5个，返回错误）                  |
| date          | 是   | string | 查询日期，格式为yyyy-MM-dd，如 2018-03-20                                                                       |
| statType      | 是   | string | CDN统计数据类型， flux表示流量明细， bandwidth表示带宽明细，requests表示请求数明细，cache表示平均请求命中率明细 |
| provs         | 否   | Array  | 省份id列表，如果为空，表示查询所有省份的数据                                                                    |
| isps          | 否   | Array  | 运营商id列表，如果为空，表示查询所有运营商的数据                                                                |
| COMMON_PARAMS | 是   |        | 参见[公共参数](/document/product/266/7782#.E5.85.AC.E5.85.B1.E5.8F.82.E6.95.B0)                                 |

### 请求示例
```
http://vod.api.qcloud.com/v2/index.php?Action=DescribeCdnProvIspDetailStat&hosts.0=123.vod2.myqcloud.com&date=2017-03-20&statType=flux
&COMMON_PARAMS
```
## 接口应答

### 参数说明
| 参数名称      | 类型    | 说明                                                                                                                           |
| ------------- | ------- | ------------------------------------------------------------------------------------------------------------------------------ |
| code          | Integer | 错误码, 0: 成功, 其他值: 失败                                                                                                  |
| message       | String  | 错误信息                                                                                                                       |
| data          | Object  | 结果数据                                                                                                                       |
| data.period   | Integer | 时间粒度。如period=5，表示明细数据是5分钟一个统计点的数据，对于flux这是这5分钟内的总的流量，对于bandwidth是这5分钟内的峰值带宽 |
| data.provData | Array   | 省份统计数据，见ProvData说明                                                                                                   |
| data.ispData  | Array   | 运营商计数据，见IspData说明                                                                                                    |

#### ProvData省份统计数据
| 参数名称 | 类型   | 说明                             |
| -------- | ------ | -------------------------------- |
| host     | String | 域名                             |
| datas    | Array  | 省份统计数据明细，见ProvItemData |

#### ProvItemData
| 参数名称 | 类型    | 说明                                      |
| -------- | ------- | ----------------------------------------- |
| provId   | Integer | 运营商Id                                  |
| ispDatas | Array   | 省份分运营商统计数据明细，见IspDataDetail |

### IspDataDetail
| 参数名称 | 类型    | 说明                        |
| -------- | ------- | --------------------------- |
| ispId    | Integer | 运营商Id                    |
| datas    | Array   | CDN统计数据明细，见StatData |


#### IspData运营商统计数据
| 参数名称 | 类型   | 说明                                    |
| -------- | ------ | --------------------------------------- |
| host     | String | 域名                                    |
| datas    | Array  | 运营商统计数据明细，见据明细IspItemData |

#### IspItemData
| 参数名称  | 类型    | 说明                                                   |
| --------- | ------- | ------------------------------------------------------ |
| ispId     | Integer | 运营商Id                                               |
| provDatas | Array   | 运营商分省份统计数据明细，见统计数据明细ProvDataDetail |

### ProvDataDetail
| 参数名称 | 类型    | 说明                                    |
| -------- | ------- | --------------------------------------- |
| provId   | Integer | 省份Id                                  |
| datas    | Array   | CDN统计数据明细，见统计数据明细StatData |


#### StatData
| 参数名称 | 类型    | 说明                                                           |
| -------- | ------- | -------------------------------------------------------------- |
| time     | string  | 统计项所属时间,格式为yyyy-MM-dd HH:mm:ss如 2018-03-20 00:00:00 |
| value    | Integer | CDN统计项数值                                                  |


### 省份映射
| 省份Id | 省份名称 |
| ------ | -------- |
| 22     | 北京     |
| 86     | 内蒙古   |
| 146    | 山西     |
| 1069   | 河北     |
| 1177   | 天津     |
| 119    | 宁夏     |
| 152    | 陕西     |
| 1208   | 甘肃     |
| 1467   | 青海     |
| 1468   | 新疆     |
| 145    | 黑龙江    |
| 1445   | 吉林     |
| 1464   | 辽宁     |
| 2      | 福建     |
| 120    | 江苏     |
| 121    | 安徽     |
| 122    | 山东     |
| 1050   | 上海     |
| 1442   | 浙江     |
| 18     | 河南     |
| 1135   | 湖北     |
| 1465   | 江西     |
| 1466   | 湖南     |
| 118    | 贵州     |
| 153    | 云南     |
| 1051   | 重庆     |
| 1068   | 四川     |
| 1155   | 西藏     |
| 4      | 广东     |
| 173    | 广西     |
| 1441   | 海南     |
| 0      | 其他     |
| 1      | 港澳台   |
| -1     | 海外     |
 
### 运营商映射
| 运营商Id | 运营商名称 |
| -------- | ---------- |
| 2        | 中国电信   |
| 26       | 中国联通   |
| 38       | 教育网     |
| 43       | 长城宽带   |
| 1046     | 中国移动   |
| 3947     | 中国铁通   |
| -1       | 海外运营商 |
| 0        | 其它运营商 |

### 错误码说明
| 错误码    | 含义说明                                     |
| --------- | -------------------------------------------- |
| 4000-7000 | 参见[公共错误码](/document/product/266/7783) |
| 1         | 内部错误                                     |
| 1000      | 无效参数                                     |
| 1001      | 内部错误                                     |
| 1003      | 内部错误                                     |
| 2000      | 内部错误                                     |
| 10022     | 内部错误                                     |

### 应答示例
```javascript
{
	"code": 0,
	"message": "",
	"data": {
		"provData": [{
			"host": "123.vod2.myqcloud.com",
			"datas": [{
				"provId": 1,
				"ispDatas": [{
					"ispId": 2,
					"datas": [{
						"time": "2017-02-20 00:00:00",
						"value": 12333
					}, {
						"time": "2017-02-20 00:05:00",
						"value": 2333
					}]
				}, {
					"ispId": 3,
					"datas": [{
						"time": "2017-02-20 00:00:00",
						"value": 12333
					}, {
						"time": "2017-02-20 00:05:00",
						"value": 2333
					}]
				}]
			}]
		}],
		"ispData": [{
			"host": "123.vod2.myqcloud.com",
			"datas": [{
				"ispId": 1,
				"provDatas": [{
					"provId": 2,
					"datas": [{
						"time": "2017-02-20 00:00:00",
						"value": 12333
					}, {
						"time": "2017-02-20 00:05:00",
						"value": 2333
					}]
				}, {
					"provId": 3,
					"datas": [{
						"time": "2017-02-20 00:10:00",
						"value": 12333
					}, {
						"time": "2017-02-20 00:15:00",
						"value": 2333
					}]
				}]
			}]
		}]
	}
}
```
